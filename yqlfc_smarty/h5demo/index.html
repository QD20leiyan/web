<!doctype html>
<html><head>
<meta charset="utf-8" />
<meta name="author" content="Tencent-TGideas">
<meta name="format-detection" content="telephone=no" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no,minimal-ui"/>
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<link href="css/style.css" rel="stylesheet">
<title>卢正雨因为说错一句话，当场被叫停</title>
<script type="text/javascript">
    var u = navigator.userAgent, app = navigator.appVersion;  
    var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Linux') > -1; //android终端或者uc浏览器  
    var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端 
    if(isAndroid){
       location.href="main.html"
    }
    var jinzhi=0;
    document.addEventListener("touchmove",function(e){
    if(jinzhi==0){
    e.preventDefault();
    e.stopPropagation();
    }
},false);
 var browser={
    versions:function(){
        var u = navigator.userAgent, app = navigator.appVersion;
        return {
            webKit: u.indexOf('AppleWebKit') > -1,
            ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),
            android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1,
            weixin: u.indexOf('MicroMessenger') > -1,
            txnews: u.indexOf('qqnews') > -1,
            sinawb: u.indexOf('weibo') > -1,
            mqq   : u.indexOf('QQ') > -1
        };
    }(),
    language:(navigator.browserLanguage || navigator.language).toLowerCase()
};
</script>
</head>
<body>
<div class="wrap">
    <div class="page page1">
            <div class="content">
                <div class="img-box" id="v1Box">
                    <div class="poster"></div>
                    <video class="video-box" data-index="1" id="videoIndex1"  x-webkit-airplay="true" webkit-playsinline="true"  playsinline   preload="auto"  webkit-playsinline src="video/1.mp4" poster=""></video>
                </div>
                <div id="well" class="slide">
                     <h2><strong id="slider"> <img src="images/top.png" class=""></strong><span><p>看看卢正雨说了啥</p></span></h2>
                     <i><img src="images/jiantou.png"></i>
                </div>
            </div>
    </div>
    </div>
<div id="orientLayer" class="mod-orient-layer">
    <div class="mod-orient-layer__content"> <i class="icon mod-orient-layer__icon-orient"></i>
        <div class="mod-orient-layer__desc">为了更好的体验，请使用竖屏浏览</div>
    </div>
</div>
<script src="js/jquery-1.7.2.min.js"></script>
<script src="js/zepto.min.js"></script>
<script src="js/ping.js"></script>
<script src="js/public.js"></script>
<script src='js/jquery-ui.min.js'></script>
<script src='js/slidetounlock.js'></script>
<script>
var md=document.getElementsByTagName("video")[0];
    md.addEventListener("ended",function(){
         $(".slide").show();
    });
 $("#result").click(function(){
     $(".handbox").hide();
});
 $('#slider')[0].addEventListener('touchmove', function(event) {
        event.preventDefault();
        var el = event.target;
        var touch = event.touches[0];
        curX = touch.pageX - this.offsetLeft - 53;
        if(curX <= 0) return;
        if(curX > 200){
            $('#well').fadeOut();
            location.href="index_2.html";
        }
        el.style.webkitTransform = 'translateX(' + curX + 'px)'; 
    }, false);
var query = function(selector){
    return document.querySelector(selector);
};
if (browser.versions.ios){
var v1 = query('#videoIndex1');
v1.play();
};
function wxPlay() {
    v1.play();
};
if (browser.versions.ios&&browser.versions.weixin){
    if (typeof WeixinJSBridge == "object" && typeof WeixinJSBridge.invoke == "function") {
        wxPlay();
    } else {
        if (document.addEventListener) {
            document.addEventListener("WeixinJSBridgeReady", wxPlay, false);
        } else if (document.attachEvent) {
            document.attachEvent("WeixinJSBridgeReady", wxPlay);
            document.attachEvent("onWeixinJSBridgeReady", wxPlay);
        }
    };
}
if (browser.versions.android||browser.versions.txnews){
    $(".poster").addClass("poster-show");
    $("#videoIndex3").attr("controls",true);

    var initV1 = function (){
        if (v1.currentTime>0){
            $(".poster").hide();
            v2.removeEventListener("timeupdate", initV2, false);
        }
    }
    var v1 = query('#videoIndex1');
    v1.addEventListener("timeupdate", initV1, false);

    var initV2 = function (){
        if (v2.currentTime>0){
            v2.pause();
            v2.removeEventListener("timeupdate", initV2, false);
        }
    }

     $(document).one('touchstart', function (e) {
        var v2 = query('#videoIndex2');
        v2.play();
     });


    var isPlay = false;

    $(document).on("touchmove",function(){
        if (isPlay) return;
    });

}

var a = document.documentElement.clientHeight, s = document.documentElement.clientWidth;
 $(".video-box").each(function(){
    $(this)[0].addEventListener("play",function(evt) {
        videoUtil.onPlay();
    });

    $(this)[0].addEventListener("ended",function(evt) {
        var evtTarget = evt.target || evt.srcElement;
        videoUtil.onEnd(evtTarget.getAttribute('data-index'))
    });

});


function wxPlay2() {
     query("#videoIndex2").play();
};
var videoUtil = {
    onPlay:function() {},
    onEnd:function(a) {
        switch (a) {
          case "1":
    if (browser.versions.ios&&browser.versions.weixin){
        WeixinJSBridge.invoke('WeixinJSBridge',{},function(e){
            //第二段视频控制处
            $("#slider").on('swipeRight',function(){
                $(".page1").hide();
                query("#videoIndex2").play();
                pgvSendClick({hottag:'a20150826kris.v2.play'});
            })
            
        });
    }
            break;

          case "2":
            $(".handbox").show();
             $("#result").click(function(){
                 $(".handbox").hide();
             })
            break;

          case "3":
        }
    },
    onError:function() {}
};
var sharePop = function() {
//    var o = query("#shareOverlay");
//    var cls = o.className;
    var show = function() {
        o.style.zIndex = 80;
        o.className = "overlay overlay-show";
        pgvSendClick({hottag:'a20150826kris.sharepop.show'});
    };
    var hide = function() {
        o.className = cls.replace(/overlay-show/, "");
        setTimeout(function() {
            o.style.zIndex = 1;
        }, 300);
    };
    return {
        show:show,
        hide:hide
    };
}();
var loadImage = function(path, callback) {
    var img = new Image();
    img.src = path;
    img.onload = function() {
        img.onload = null;
        callback(path);
    };
};
$(function(){
    var _url = "";
    loadImage(_url+"sp_end.png", function(path){
        $(".spe").css("background-image","url("+path+")");
    });
    loadImage(_url+"bg_end.jpg", function(path){
        $(".page5").css("background-image","url("+path+")");
    });
    if (browser.versions.weixin){
        query(".btn-share").innerHTML='777';
        query(".btn-share").setAttribute('href','');
    }else{
        loadImage(_url+"bg_share.png", function(path){
            $(".overlay .arrow").css("background-image","url("+path+")");
        });
    }
    if(typeof(pgvMain) == 'function') pgvMain();
});
function loadScript(url, callback) {
    var script = document.createElement('script');
    script.type = "text/javascript";
    if (script.readyState) {
        script.onreadystatechange = function() {
            if (script.readyState == "loaded" || script.readyState == "complete") {
                script.onreadystatechange = null;
                if (callback) {
                    callback()
                }
            }
        }
    } else {
        script.onload = function() {
            if (callback) {
                callback()
            }
        }
    }
    script.src = url;
    document.body.appendChild(script)
};
</script>   
</body>
</html>